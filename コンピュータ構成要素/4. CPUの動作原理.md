# CPU の動作原理

- CPU は演算装置と制御装置でできている

## レジスタ

- CPU に内蔵されている高速な**記憶装置**
- いっぱい種類がある
  - 命令レジスタ
  - 命令アドレスレジスタ
  - 指標レジスタ
  - 基底レジスタ
  - アキュムレータ
  - 汎用レジスタ

## 命令語

- 1 と 0 の機械語のこと
- 命令部とアドレス部で構成される
  - 命令部: 指示内容
  - アドレス部: 処理対象となるデータの主記憶上のアドレス

## 命令実行サイクル

### 登場人物

- 主記憶
  - 命令
  - データ
- CPU: 鎧
  - 制御装置
    - 命令アドレスレジスタ: ウサギ
    - 命令レジスタ: ちいかわ
    - アドレスレジスタ : モモンガ
    - デコーダ (解読器) : ハチワレ
  - 演算装置: 栗まんじゅう

1. 命令を取り出す

   1. 命令アドレスレジスタを参照し、命令が格納されている主記憶上のアドレスを取得する
   2. 取得したアドレスから命令を取り出し、命令レジスタに格納する
   3. 命令アドレスレジスタに次の命令をセットする

2. 命令の解読
   1. 命令レジスタの命令部 → デコーダで解読され、演算装置に指示を出す
3. 実行アドレス計算
   1. 命令レジスタのアドレス部 → アドレスレジスタに送られ、処理対象のデータが格納されているアドレス（実効アドレス）を計算する
4. オペランドの取り出し
   1. 処理対象のデータを取り出し演算装置に送る
5. 命令の実行
6. 演算結果をデータに格納する

### カタカナが多く画像としてイメージが持てないのでちいかわに置き換えてみる

ウサギは主記憶上のどこに命令が格納されているか知っている

鎧さんはウサギに聞いたアドレスから命令を取り出してちいかわに渡す
鎧さんはウサギに次の命令をセットする

鎧さんはちいかわの命令部をハチワレに託す
ハチワレが解読して言語化したものを鎧さんが栗まんじゅうに渡す
鎧さんはちいかわのアドレス部をモモンガに送る
モモンガはどこにデータが格納されているか、アドレスを計算する

鎧さんはモモンガから取得したアドレスから処理対象のデータを取り出し、栗まんじゅうに渡す
栗まんじゅうはハチワレから命令を受け取り、モモンガからデータを受け取っているのでその２つを使って演算処理を行い、結果をデータに格納して返す

## アドレス指定方式

本がわかりやすいので割愛

- 即値アドレス指定方式
- 直接
- 間接
- 相対
  - アドレス部とプログラムカウンタの和
- 指標
  - アドレス部と指標レジスタの値の和
- 基底
  - アドレス部と基底レジスタの値の和
